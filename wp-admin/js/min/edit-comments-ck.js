var setCommentsList,theList,theExtraList,commentReply;!function(t){var e,n,a;setCommentsList=function(){var o,s,r,i,l,c,p,m,d,u=0;o=t('input[name="_total"]',"#comments-form"),s=t('input[name="_per_page"]',"#comments-form"),r=t('input[name="_page"]',"#comments-form"),i=function(e,n){var o,s,r,i=t("#"+n.element);o=t("#replyrow"),s=t("#comment_ID",o).val(),r=t("#replybtn",o),i.is(".unapproved")?(n.data.id==s&&r.text(adminCommentsL10n.replyApprove),i.find("div.comment_status").html("0")):(n.data.id==s&&r.text(adminCommentsL10n.reply),i.find("div.comment_status").html("1")),d=t("#"+n.element).is("."+n.dimClass)?1:-1,a(d)},l=function(e,n){var a,i,l,c,p,m,d,u=!1,h=t(e.target).attr("data-wp-lists");return e.data._total=o.val()||0,e.data._per_page=s.val()||0,e.data._page=r.val()||0,e.data._url=document.location.href,e.data.comment_status=t('input[name="comment_status"]',"#comments-form").val(),-1!=h.indexOf(":trash=1")?u="trash":-1!=h.indexOf(":spam=1")&&(u="spam"),u&&(i=h.replace(/.*?comment-([0-9]+).*/,"$1"),l=t("#comment-"+i),a=t("#"+u+"-undo-holder").html(),l.find(".check-column :checkbox").prop("checked",!1),l.siblings("#replyrow").length&&commentReply.cid==i&&commentReply.close(),l.is("tr")?(c=l.children(":visible").length,d=t(".author strong",l).text(),p=t('<tr id="undo-'+i+'" class="undo un'+u+'" style="display:none;"><td colspan="'+c+'">'+a+"</td></tr>")):(d=t(".comment-author",l).text(),p=t('<div id="undo-'+i+'" style="display:none;" class="undo un'+u+'">'+a+"</div>")),l.before(p),t("strong","#undo-"+i).text(d),m=t(".undo a","#undo-"+i),m.attr("href","comment.php?action=un"+u+"comment&c="+i+"&_wpnonce="+e.data._ajax_nonce),m.attr("data-wp-lists","delete:the-comment-list:comment-"+i+"::un"+u+"=1"),m.attr("class","vim-z vim-destructive"),t(".avatar",l).first().clone().prependTo("#undo-"+i+" ."+u+"-undo-inside"),m.click(function(){return n.wpList.del(this),t("#undo-"+i).css({backgroundColor:"#ceb"}).fadeOut(350,function(){t(this).remove(),t("#comment-"+i).css("backgroundColor","").fadeIn(300,function(){t(this).show()})}),!1})),e},c=function(t,e,n){u>e||(n&&(u=e),o.val(t.toString()))},e=function(t){var e=parseInt(t.html().replace(/[^0-9]+/g,""),10);return isNaN(e)?0:e},n=function(t,e){var n="";if(!isNaN(e)){if(e=1>e?"0":e.toString(),e.length>3){for(;e.length>3;)n=thousandsSeparator+e.substr(e.length-3)+n,e=e.substr(0,e.length-3);e+=n}t.html(e)}},a=function(a){t("span.pending-count").each(function(){var o=t(this),s=e(o)+a;1>s&&(s=0),o.closest(".awaiting-mod")[0===s?"addClass":"removeClass"]("count-0"),n(o,s)})},p=function(s,r){function i(e){return t(r.target).parent().is("span."+e)?1:t("#"+r.element).is("."+e)?-1:0}var l,p,d,h,f,g=t(r.target).parent().is("span.untrash"),v=t(r.target).parent().is("span.unspam"),y=t("#"+r.element).is(".unapproved");h=g?-1:i("trash"),d=v?-1:i("spam"),t(r.target).parent().is("span.unapprove")||(g||v)&&y?f=1:y&&(f=-1),f&&a(f),t("span.spam-count").each(function(){var a=t(this),o=e(a)+d;n(a,o)}),t("span.trash-count").each(function(){var a=t(this),o=e(a)+h;n(a,o)}),t("#dashboard_right_now").length||(p=o.val()?parseInt(o.val(),10):0,t(r.target).parent().is("span.undo")?p++:p--,0>p&&(p=0),"object"==typeof s&&u<r.parsed.responses[0].supplemental.time?(l=r.parsed.responses[0].supplemental.total_items_i18n||"",l&&(t(".displaying-num").text(l),t(".total-pages").text(r.parsed.responses[0].supplemental.total_pages_i18n),t(".tablenav-pages").find(".next-page, .last-page").toggleClass("disabled",r.parsed.responses[0].supplemental.total_pages==t(".current-page").val())),c(p,r.parsed.responses[0].supplemental.time,!0)):c(p,s,!1)),!theExtraList||0===theExtraList.size()||0===theExtraList.children().size()||g||v||(theList.get(0).wpList.add(theExtraList.children(":eq(0)").remove().clone()),m())},m=function(e){var n=t.query.get(),a=t(".total-pages").text(),o=t('input[name="_per_page"]',"#comments-form").val();n.paged||(n.paged=1),n.paged>a||(e?(theExtraList.empty(),n.number=Math.min(8,o)):(n.number=1,n.offset=Math.min(8,o)-1),n.no_placeholder=!0,n.paged++,!0===n.comment_type&&(n.comment_type=""),n=t.extend(n,{action:"fetch-list",list_args:list_args,_ajax_fetch_list_nonce:t("#_ajax_fetch_list_nonce").val()}),t.ajax({url:ajaxurl,global:!1,dataType:"json",data:n,success:function(t){theExtraList.get(0).wpList.add(t.rows)}}))},theExtraList=t("#the-extra-comment-list").wpList({alt:"",delColor:"none",addColor:"none"}),theList=t("#the-comment-list").wpList({alt:"",delBefore:l,dimAfter:i,delAfter:p,addColor:"none"}).bind("wpListDelEnd",function(e,n){var a=t(n.target).attr("data-wp-lists"),o=n.element.replace(/[^0-9]+/g,"");(-1!=a.indexOf(":trash=1")||-1!=a.indexOf(":spam=1"))&&t("#undo-"+o).fadeIn(300,function(){t(this).show()})})},commentReply={cid:"",act:"",init:function(){var e=t("#replyrow");t("a.cancel",e).click(function(){return commentReply.revert()}),t("a.save",e).click(function(){return commentReply.send()}),t("input#author, input#author-email, input#author-url",e).keypress(function(t){return 13==t.which?(commentReply.send(),t.preventDefault(),!1):void 0}),t("#the-comment-list .column-comment > p").dblclick(function(){commentReply.toggle(t(this).parent())}),t("#doaction, #doaction2, #post-query-submit").click(function(){t("#the-comment-list #replyrow").length>0&&commentReply.close()}),this.comments_listing=t('#comments-form > input[name="comment_status"]').val()||""},addEvents:function(e){e.each(function(){t(this).find(".column-comment > p").dblclick(function(){commentReply.toggle(t(this).parent())})})},toggle:function(e){"none"!=t(e).css("display")&&t(e).find("a.vim-q").click()},revert:function(){return t("#the-comment-list #replyrow").length<1?!1:(t("#replyrow").fadeOut("fast",function(){commentReply.close()}),!1)},close:function(){var e,n=t("#replyrow");n.parent().is("#com-reply")||(this.cid&&"edit-comment"==this.act&&(e=t("#comment-"+this.cid),e.fadeIn(300,function(){e.show()}).css("backgroundColor","")),"undefined"!=typeof QTags&&QTags.closeAllTags("replycontent"),t("#add-new-comment").css("display",""),n.hide(),t("#com-reply").append(n),t("#replycontent").css("height","").val(""),t("#edithead input").val(""),t(".error",n).html("").hide(),t(".spinner",n).hide(),this.cid="")},open:function(e,n,a){var o,s,r,i,l,c=this,p=t("#comment-"+e),m=p.height();return c.close(),c.cid=e,o=t("#replyrow"),s=t("#inline-"+e),a=a||"replyto",r="edit"==a?"edit":"replyto",r=c.act=r+"-comment",t("#action",o).val(r),t("#comment_post_ID",o).val(n),t("#comment_ID",o).val(e),"edit"==a?(t("#author",o).val(t("div.author",s).text()),t("#author-email",o).val(t("div.author-email",s).text()),t("#author-url",o).val(t("div.author-url",s).text()),t("#status",o).val(t("div.comment_status",s).text()),t("#replycontent",o).val(t("textarea.comment",s).val()),t("#edithead, #savebtn",o).show(),t("#replyhead, #replybtn, #addhead, #addbtn",o).hide(),m>120&&(l=m>500?500:m,t("#replycontent",o).css("height",l+"px")),p.after(o).fadeOut("fast",function(){t("#replyrow").fadeIn(300,function(){t(this).show()})})):"add"==a?(t("#addhead, #addbtn",o).show(),t("#replyhead, #replybtn, #edithead, #editbtn",o).hide(),t("#the-comment-list").prepend(o),t("#replyrow").fadeIn(300)):(i=t("#replybtn",o),t("#edithead, #savebtn, #addhead, #addbtn",o).hide(),t("#replyhead, #replybtn",o).show(),p.after(o),i.text(p.hasClass("unapproved")?adminCommentsL10n.replyApprove:adminCommentsL10n.reply),t("#replyrow").fadeIn(300,function(){t(this).show()})),setTimeout(function(){var e,n,a,o,s;e=t("#replyrow").offset().top,n=e+t("#replyrow").height(),a=window.pageYOffset||document.documentElement.scrollTop,o=document.documentElement.clientHeight||window.innerHeight||0,s=a+o,n>s-20?window.scroll(0,n-o+35):a>e-20&&window.scroll(0,e-35),t("#replycontent").focus().keyup(function(t){27==t.which&&commentReply.revert()})},600),!1},send:function(){var e={};return t("#replysubmit .error").hide(),t("#replysubmit .spinner").show(),t("#replyrow input").not(":button").each(function(){var n=t(this);e[n.attr("name")]=n.val()}),e.content=t("#replycontent").val(),e.id=e.comment_post_ID,e.comments_listing=this.comments_listing,e.p=t('[name="p"]').val(),t("#comment-"+t("#comment_ID").val()).hasClass("unapproved")&&(e.approve_parent=1),t.ajax({type:"POST",url:ajaxurl,data:e,success:function(t){commentReply.show(t)},error:function(t){commentReply.error(t)}}),!1},show:function(e){var n=this,o,s,r,i,l;return"string"==typeof e?(n.error({responseText:e}),!1):(o=wpAjax.parseAjaxResponse(e),o.errors?(n.error({responseText:wpAjax.broken}),!1):(n.revert(),o=o.responses[0],r="#comment-"+o.id,"edit-comment"==n.act&&t(r).remove(),o.supplemental.parent_approved&&(l=t("#comment-"+o.supplemental.parent_approved),a(-1),"moderated"==this.comments_listing)?void l.animate({backgroundColor:"#CCEEBB"},400,function(){l.fadeOut()}):(s=t.trim(o.data),t(s).hide(),t("#replyrow").after(s),r=t(r),n.addEvents(r),i=r.hasClass("unapproved")?"#FFFFE0":r.closest(".widefat, .postbox").css("backgroundColor"),void r.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:i},300,function(){l&&l.length&&l.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:i},300).removeClass("unapproved").addClass("approved").find("div.comment_status").html("1")}))))},error:function(e){var n=e.statusText;t("#replysubmit .spinner").hide(),e.responseText&&(n=e.responseText.replace(/<.[^<>]*?>/g,"")),n&&t("#replysubmit .error").html(n).show()},addcomment:function(e){var n=this;t("#add-new-comment").fadeOut(200,function(){n.open(0,e,"add"),t("table.comments-box").css("display",""),t("#no-comments").remove()})}},t(document).ready(function(){var e,n,a,o;setCommentsList(),commentReply.init(),t(document).delegate("span.delete a.delete","click",function(){return!1}),"undefined"!=typeof t.table_hotkeys&&(e=function(e){return function(){var n,a;n="next"==e?"first":"last",a=t(".tablenav-pages ."+e+"-page:not(.disabled)"),a.length&&(window.location=a[0].href.replace(/\&hotkeys_highlight_(first|last)=1/g,"")+"&hotkeys_highlight_"+n+"=1")}},n=function(e,n){window.location=t("span.edit a",n).attr("href")},a=function(){t("#cb-select-all-1").data("wp-toggle",1).trigger("click").removeData("wp-toggle")},o=function(e){return function(){var n=t('select[name="action"]');t('option[value="'+e+'"]',n).prop("selected",!0),t("#doaction").click()}},t.table_hotkeys(t("table.widefat"),["a","u","s","d","r","q","z",["e",n],["shift+x",a],["shift+a",o("approve")],["shift+s",o("spam")],["shift+d",o("delete")],["shift+t",o("trash")],["shift+z",o("untrash")],["shift+u",o("unapprove")]],{highlight_first:adminCommentsL10n.hotkeys_highlight_first,highlight_last:adminCommentsL10n.hotkeys_highlight_last,prev_page_link_cb:e("prev"),next_page_link_cb:e("next"),hotkeys_opts:{disableInInput:!0,type:"keypress",noDisable:'.check-column input[type="checkbox"]'}}))})}(jQuery);